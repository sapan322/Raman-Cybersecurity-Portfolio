# Malware Analysis Report â€” RAT.Unknown2.exe  

**A Practical Demonstration of Malware Analysis and Threat Intelligence Skills**  

---

## Overview  

**Malware Sample:** RAT.Unknown2.exe  
**Source:** [PMAT-labs](https://github.com/HuskyHacks/PMAT-labs/tree/main)  

**Objective:**  
Conduct in-depth static and dynamic analysis of the malware sample, identify its capabilities, and document technical findings and indicators of compromise (IOCs).  

**Key Skills Demonstrated:**  
- Static malware analysis  
- Dynamic behavior analysis  
- Threat detection and IOC extraction  
- Basic reverse engineering techniques  
- Professional technical reporting  

**Tools and Environment:**  
- **Infrastructure:** Proxmox, FLARE-VM, Remnux, pfSense  
- **Static Analysis:** VirusTotal, FLOSS, pestudio, PE-bear  
- **Dynamic Analysis:** TCPview, netcat, Wireshark, Procmon  

---

## Key Findings  

### 1. Static Analysis  

- **File Hashes:**  
  - SHA-256: `481eae82ac4cd1a9cfadc026a628b18d7b4c54f50385d28c505fbcb3e999b8b0`  
  - MD5: `c211704777e168a5151de79dc87ffac7`  

- **VirusTotal Results:**  
  - Detection rate: **45/72**   

- **Suspicious Strings (FLOSS / pestudio):**  
    ```
    socket  
    send  
    getaddrinfo  
    closesocket  
    connect  
    GetCurrentProcess  
    CreateProcessW  
    @cmd.exe /c  
    KERNEL32.dll  
    msvcrt.dll  
    USER32.dll  
    DWORD  
    ```  

- **PE Structure (PE-bear):**  
  - Packed: **No**  
  - Compilation Timestamp: **2021-09-18**  
  - Notable imported API calls:  
    ```
    GetCurrentProcess  
    GetCurrentProcessId  
    GetCurrentThreadId  
    RtlAddFunctionTable  
    VirtualAlloc  
    VirtualProtect  
    VirtualQuery  
    ```  

- **Static Analysis Summary:**  
  - **Likely functionality:** Indicators point to Remote Access Trojan (RAT) functionality with the ability to establish remote connections and execute system commands via a command-and-control (C2) server.  
  - **Potential Indicators of Compromise (IOCs):**  
    - Outbound TCP connections to suspicious IP addresses  
    - Reverse shell activity over uncommon protocols  
    - Command execution via `cmd.exe` triggered by the malicious binary  

---

### 2. Dynamic Analysis  

- **Observed Behavior:**  
  - No visible UI or CLI prompts  
  - No observed file creation or deletion (likely operating in-memory)  
  - No persistence mechanisms detected  
  - C2 communication behavior:  
    - Establishes a reverse TCP shell over port 443, impersonating legitimate HTTPS traffic  

- **Reproducing Reverse Shell Behavior:**  
  1. Disable simulated HTTPS service on INetSim.  
  2. Launch netcat listener on Remnux (port 443).  
  3. Execute the sample on FLARE-VM.  
  4. The malware issues a DNS query to a crafted domain.  
  5. Upon receiving a DNS reply with an IP address, a TCP connection is established.  
  6. A reverse shell session is initiated.  

- **Network Indicators (Wireshark):**  
  - DNS request:  
    ```
    A aaaaaaaaaaaaaaaaaaaa.kadusus.local
    ```  
  - Outbound TCP handshake to the DNS-resolved IP  
  - Plain-text C2 communication transmitted over port 443  

- **Host-Based Indicators (Procmon, TCPview):**  
  - Outbound TCP connections originating from the malicious process  
  - Observed execution of remote commands through the established reverse shell  

- **Execution Flow:**  
  - DNS query issued to `aaaaaaaaaaaaaaaaaaaa.kadusus.local`  
  - Upon DNS response, TCP handshake and connection establishment follow  
  -  If no DNS response is received, the malware terminates execution  

---

## Screenshots  

| Tool                      | Description                                                                    |
|---------------------------|--------------------------------------------------------------------------------|
| ![VirusTotal](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%233%20VT.png)           | VirusTotal detection results                                                   |
| ![Imported functions](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%233%20pe-bear%20imported%20functions.png)      | PE-bear analysis showing imported Windows API functions                        |
| ![Wireshark](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%233%20Wireshark%20DNS%20request.png)            | Captured DNS query (Wireshark)                                                 |
| ![Procmon](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%233%20Procmon%20Established%20TCP%20session.png)              | TCP session establishment logged by Procmon                                    |
| ![TCPview](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%233%20TCPview%20established%20TCP%20shell.png)              | Established TCP connection visible in TCPview                                  |
| ![Netcat interaction](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%233%20netcat%20reverse%20TCP%20shell.png)   | Reverse TCP shell interaction captured with netcat                             |
| ![Command execution proof](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%233%20Remote%20Commands%20Execution.png) | Demonstration of remote command execution via the reverse shell                |

---

## Indicators of Compromise (IOCs)  

- **Network IOCs:**  
  - DNS Query Domain: `aaaaaaaaaaaaaaaaaaaa.kadusus.local`  
  - Outbound TCP connections to external IP addresses over port 443  
  - Long-lived TCP sessions indicating potential reverse shell activity  

- **Host-Based IOCs:**  
  - Suspicious outbound TCP connections initiated by an unknown binary  
  - Remote command execution triggered from an established TCP session  

---

## Key Takeaways  

- **Skill Development:**  
  - Applied static and dynamic analysis techniques to real malware samples  
  - Practiced IOC extraction and structured documentation  
  - Successfully reproduced reverse shell behavior in a controlled lab environment  
  - Improved understanding of DNS-based C2 mechanisms and covert communication tactics  

- **Challenges Addressed:**  
  - Interpreting obfuscated DNS queries and fallback logic  
  - Simulating attacker infrastructure to capture C2 interactions safely  
  - Identifying suspicious API imports and linking them to malicious behavior  

- **Real-World Relevance:**  
  - Demonstrates the ability to detect and analyze covert network channels  
  - Highlights techniques used by real threat actors to evade detection  
  - Builds skills critical for SOC analysts, malware researchers, and incident responders  

---

## For Employers  

This report demonstrates my ability to:  
- Build and manage an isolated malware analysis environment  
- Conduct thorough static and dynamic analysis of unknown samples  
- Extract and document actionable IOCs  
- Recreate and understand attacker techniques  
- Communicate complex technical findings in a clear and professional format  

---

**View this and other reports on my GitHub:**  
[My Cybersecurity Portfolio](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/tree/main)

