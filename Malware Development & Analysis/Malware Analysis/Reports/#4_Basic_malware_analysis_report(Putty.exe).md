# Malware Analysis Report â€” Putty.exe  

**A Practical Demonstration of Malware Analysis and Threat Intelligence Skills**  

---

## Overview  

**Malware Sample:** Putty.exe
**Source:** [PMAT-labs](https://github.com/HuskyHacks/PMAT-labs)

**Objective:**  
Conduct in-depth static and dynamic analysis of the malware sample, identify its capabilities, and document technical findings and indicators of compromise (IOCs).  

**Key Skills Demonstrated:**  
- Static malware analysis  
- Dynamic behavior analysis  
- Threat detection and IOC extraction  
- Basic reverse engineering techniques  
- Professional technical reporting  

**Tools and Environment:**  
- **Infrastructure:** Proxmox, FLARE-VM, Remnux, pfSense, INetSim  
- **Static Analysis:** VirusTotal, FLOSS, pestudio, PE-bear, PEView, CyberChef  
- **Dynamic Analysis:** TCPview, netcat, Wireshark, Procmon, INetSim  

---

## Key Findings  

### 1. Static Analysis  

- **File Hashes:**  
  - SHA-256: `0c82e654c09c8fd9fdf4899718efa37670974c9eec5a8fc18a167f93cea6ee83`  
  - MD5: `334a10500feb0f3444bf2e86ab2e76da`  

- **VirusTotal Results:**  
  - Detection rate: **61/72**   

- **Suspicious Strings (FLOSS / pestudio):**  
    ```  
            SSHCONNECTION@putty.projects.tartarus.org-2.0-
		Proxy error: Error while communicating with proxy
		Options controlling Telnet connections
		Using 3DES encryption
		hmac-sha2-256-etm@openssh.com
		HTTP
		https://www.chiark.greenend.org.uk/~sgtatham/putty/
		CryptoCard authentication response:
		CONNECT %s:%i HTTP/1.1
		Pageant.exe
		PuTTYgen.exe
    ```
  **Malware is RAT (infected software that impersonate legitimate).** It contains 20.161 strings. So it's hard to separate strings that added by threat actor. But i find one string that realy attract my attention
  [`powershell.exe ...`](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/txt_files/%234_malware_powershell_string.md) - a malicious hidden powershell command with script (Base64 encoded and packed with gunzip)

  **CyberChef is used** to decode script ([decoded script link](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/txt_files/%234_malware_decoded_script.md)). Script create a TLS encrypted reverse shell by TCP on `8443` port that give a remote access to system. Allowing to execute commands from C2 server on fake domain `bonus2.corporatebonusapplication.local`

- **PE Structure (PE-bear):**  
  - Packed: **No**  
  - Compilation Timestamp: **10.07.2021**  
  - Notable imported API calls:  
    ```  
     ShellExecuteA
		CreateProcessA
		CreateFileA
		DeleteFileA
		FindFirstFileA
		FindFirstFileExW
		GetCurrentProcess
		GetCurrentProcessId
		GetCurrentThread
		GetCurrentThreadId
		GetThreadTimes
		GlobalMemoryStatus
		WriteFile
    ```
    **Malware is RAT (infected software that impersonate legitimate).** 326 imported functions that hard to separate that added by threat actor.  

- **Static Analysis Summary:**  
  - **Likely functionality:** Malware establish a reverse shell with C2 server on domain `bonus2.corporatebonusapplication.local`. Session is encrypted by TLS. Malware can download additional payloads and give full remote access to system. (RAT)    
  - **Potential Indicators of Compromise (IOCs):**
    - Spawned `Powershell.exe` child process
    - DNS query `A bonus2.corporatebonusapplication.local`
    - Established connection to foreign IP addresses

---

### 2. Dynamic Analysis  

- **Observed Behavior:**  
  - GUI interface of legitimate software. And blank powershell.exe windows executed in background. That disappear after 1-2 seconds (screenshot attached below) 
  - C2 communication behavior:  
    - Spawned powershell.exe send DNS query to fake domain `bonus2.corporatebonusapplication.local`. Send TLS handshake to C2 IP address (DNS response)  to establish a encrypted TLS reverse shell (TCP, port 8443)

- **Reproducing C2 / Reverse Shell Behavior (if applicable):**  
  1. INetSim on Remnux will impersonate DNS server and response to DNS query with Remnux IP address.  
  2. Netcat that listen on 8443 port recieve a TLS handshake to establish a reverse shell. (Screenshot attached bellow)   
  3. Since i dont have a signed certificate, i cant establish a reverse shell       

- **Network Indicators (Wireshark):**  
  - DNS request:  
    ```  
    bonus2.corporatebonusapplication.local  
    ```  
  - Outbound TCP connection to C2 IP address (a Remnux IP address)   
  - TLS handshake

- **Host-Based Indicators (Procmon, TCPview):**  
  - Spawnded powershell.exe with malicious command (screenshot attached below)  
  - powershell.exe is establish a TCP session with C2 server (screenshot attached below) 

- **Execution Flow Summary:**  
  - Infected software named Putty.exe spawn a powershell.exe process that establish TCP session and send TLS hello to C2 server. 

---

## Screenshots  

| Tool                      | Description                                                                    |
|---------------------------|--------------------------------------------------------------------------------|
| ![VirusTotal](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234.%20VT.png)          | VirusTotal detection results                                                   |
| ![Imported functions](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20pestudio%20Imported%20Functions%20(51%20flag).png)  | pestudio analysis showing imported functions                                    |
| ![Wireshark](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20Wireshark%20-%20DNS%20querry%20to%20malicious%20domain%20name.png)          | Captured DNS query                                          |
| ![Execution](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20GUI%20Interface%20with%20Powershell.png)            | Execution - GUI interface with powershell.exe on bakcground                                           |
| ![TCPview](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20TCPview%20-%20spawned%20powershell%20establish%20TCP%20connection%20to%20C2%20server.png)            | Established network connection                                                |
| ![Netcat interaction](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20Powershell%20send%20TLS%20hello%20to%20C2.png) | TLS hello captured by netcat on `8443` port                             |
| ![Procmon](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20Procmon%20-%20malware%20spawn%20powershell.exe%20with%20malicious%20command.png)  | Spawned `powershell.exe` with malicious command                       |
| ![Procmon](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20Procmon%20-%20spawned%20PowerShell%20use%20TCP%20on%20port%208443%20.png)  | Spawned `powershell.exe` TCP connection by `8443` port                       |
| ![CyberChef](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20decoded%20powershell%20script%20with%20CyberChef.png)  | Decoded powershell script with CyberChef                       |

---

## Indicators of Compromise (IOCs)  

- **Network IOCs:**  
  - DNS Query Domain: `bonus2.corporatebonusapplication.local`  
  - Established TCP connection on port 8443 to foreign IP address.  
  - TLS handshake with foreign IP address. 

- **Host-Based IOCs:**  
  - Suspicious outbound TCP connections initiated by `powershell.exe`  
  - Observed remote command executions  

---

## Key Takeaways  

- **Skill Development:**  
  
- **Challenges Addressed:**   

- **Real-World Relevance:**  
 
---

## For Employers  

This report demonstrates my ability to:  


---

**View this and other reports on my GitHub:**  
[My Cybersecurity Portfolio](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/tree/main)

