# Malware Analysis Report — Putty.exe  

## Overview  

Conduct in-depth static and dynamic analysis of the malware sample, identify its capabilities, and document technical findings and indicators of compromise (IOCs).  

**Malware Sample:** Putty.exe  
**Source:** [PMAT-labs](https://github.com/HuskyHacks/PMAT-labs)  

**Tools and Environment:**  
- **Infrastructure:** Proxmox, FLARE-VM, Remnux, pfSense, INetSim  
- **Static Analysis:** VirusTotal, FLOSS, pestudio, PE-bear, PEView, CyberChef  
- **Dynamic Analysis:** TCPview, netcat, Wireshark, Procmon, INetSim  

---

## Key Findings  

### 1. Static Analysis  

- **File Hashes:**  
  - **SHA-256**: `0c82e654c09c8fd9fdf4899718efa37670974c9eec5a8fc18a167f93cea6ee83`  
  - **MD5**: `334a10500feb0f3444bf2e86ab2e76da`  

- **VirusTotal Results:**  
  - Detection rate: **61/72** ([screenshot attached](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20&%20Analysis/Malware%20Analysis/Reports/%234_Basic_malware_analysis_report(Putty.exe).md#screenshots))  

- **Suspicious Strings (FLOSS / pestudio):**  
    ```  
    SSHCONNECTION@putty.projects.tartarus.org-2.0-
    Proxy error: Error while communicating with proxy
    Options controlling Telnet connections
    Using 3DES encryption
    hmac-sha2-256-etm@openssh.com
    HTTP
    https://www.chiark.greenend.org.uk/~sgtatham/putty/
    CryptoCard authentication response:
    CONNECT %s:%i HTTP/1.1
    Pageant.exe
    PuTTYgen.exe
    ```  
  The malware is a **Remote Access Trojan (RAT)** masquerading as legitimate software. It contains **20,161 strings**, which makes identifying malicious additions difficult. A particularly suspicious string was identified:  
  ["powershell.exe ..."](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/txt_files/%234_malware_powershell_string.md)
  
  This hidden **PowerShell command** is **Base64-encoded and packed with gunzip**, used to establish a TLS-encrypted **reverse shell** on **port 8443**, granting remote access via a C2 server at `bonus2.corporatebonusapplication.local`.  
  The **CyberChef tool** was used to decode the script ([decoded script link](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/txt_files/%234_malware_decoded_script.md)).

- **PE Structure (PE-bear):**  
  - **Packed:** No  
  - **Notable imported API calls:**  
    ```  
    ShellExecuteA
    CreateProcessA
    CreateFileA
    DeleteFileA
    FindFirstFileA
    FindFirstFileExW
    GetCurrentProcess
    GetCurrentProcessId
    GetCurrentThread
    GetCurrentThreadId
    GetThreadTimes
    GlobalMemoryStatus
    WriteFile
    ```  
  The malware imports **326 functions**, making it difficult to isolate those added by the threat actor. ([screenshot attached](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20pestudio%20Imported%20Functions%20(51%20flag).png))

- **Static Analysis Summary:**  
  - **Functionality:**  
    - Establishes a **reverse shell** with a C2 server at `bonus2.corporatebonusapplication.local`.  
    - Uses **TLS encryption** to conceal communication.  
    - Can download additional payloads and grant full remote access.  
  - **Indicators of Compromise (IOCs):**  
    - Spawns a **Powershell.exe** child process.  
    - DNS query: `A bonus2.corporatebonusapplication.local`.  
    - Establishes connections to foreign IP addresses.  

---

### 2. Dynamic Analysis  

- **Observed Behavior:**  
  - The malware **displays a GUI interface** similar to legitimate software.  
  - **A blank PowerShell window** appears in the background for **1–2 seconds**, then disappears. ([screenshot attached](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20GUI%20Interface%20with%20Background%20Powershell.png))  
  - **C2 communication:**  
    - **Spawns powershell.exe**, which performs a DNS query to `bonus2.corporatebonusapplication.local`.  
    - Sends a **TLS handshake** to the resolved C2 IP to establish an encrypted **reverse shell** over **TCP (port 8443)**.  

- **Reproducing C2 / Reverse Shell Behavior:**  
  1. **INetSim (on Remnux)** was configured as a fake DNS server to resolve `bonus2.corporatebonusapplication.local`.  
  2. **Netcat (listening on port 8443)** received a **TLS handshake** attempting to establish a reverse shell.  
  3. Since the malware expects a **signed TLS certificate**, I was unable to establish a full **reverse shell session**.  

- **Network Indicators (Wireshark):**  
  - **DNS request:**  
    ```  
    bonus2.corporatebonusapplication.local  
    ```  
  - **Outbound TCP connection** to the resolved C2 IP address.  
  - **TLS handshake initiation.**  

- **Host-Based Indicators (Procmon, TCPview):**  
  - **powershell.exe spawned with a malicious command.** ([Screenshot attached](#screenshots))  
  - **powershell.exe establishes a TCP session with the C2 server.**  

- **Execution Flow Summary:**  
  - The **infected** Putty.exe binary **spawns** PowerShell, which **establishes a TLS-encrypted session** with a C2 server.  

---

## Screenshots  

| Tool                      | Description                                                                    |
|---------------------------|--------------------------------------------------------------------------------|
| ![VirusTotal](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234.%20VT.png)          | VirusTotal detection results                                                   |
| ![Imported functions](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20pestudio%20Imported%20Functions%20(51%20flag).png)  | pestudio analysis of imports                                    |
| ![Wireshark](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20Wireshark%20-%20DNS%20querry%20to%20malicious%20domain%20name.png)          | Captured DNS query                                          |
| ![Execution](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20GUI%20Interface%20with%20Powershell.png)            | GUI interface with background PowerShell                                           |
| ![TCPview](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20TCPview%20-%20spawned%20powershell%20establish%20TCP%20connection%20to%20C2%20server.png)            | Established C2 connection                                                 |
| ![Netcat interaction](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20Powershell%20send%20TLS%20hello%20to%20C2.png) | TLS handshake on port 8443                            |
| ![Procmon](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20Procmon%20-%20malware%20spawn%20powershell.exe%20with%20malicious%20command.png)  | Spawned `powershell.exe` with malicious command                       |
| ![CyberChef](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/blob/main/Malware%20Development%20%26%20Analysis/Malware%20Analysis/Reports/screenshots/%234%20decoded%20powershell%20script%20with%20CyberChef.png)  | Decoded PowerShell script                       |

---

## Indicators of Compromise (IOCs)  

- **Network IOCs:**  
  - **DNS Query:** `bonus2.corporatebonusapplication.local`  
  - **TCP connection on port 8443** to a **foreign IP address**  
  - **TLS handshake** with the C2 server  

- **Host-Based IOCs:**  
  - **powershell.exe** making **suspicious outbound TCP connections**  
  - **Remote command execution** observed  

---

## Key Takeaways  

- **Skill Development:**  
  - Conducting static and dynamic malware analysis.  
  - Identifying **malicious PowerShell execution**.  
  - Analyzing **network-based** IOCs using **Wireshark and INetSim**.  

- **Challenges Addressed:**  
  - Handling **obfuscated PowerShell payloads**.  
  - Emulating **C2 behavior** in a controlled environment.  

- **Real-World Relevance:**  
  - Demonstrates **practical threat analysis skills** for a **Security Analyst role**.  

---

## For Employers  

This report demonstrates my ability to:  
- Analyze malware using static and dynamic techniques.  
- Identify **indicators of compromise** for threat intelligence.  
- Investigate malicious PowerShell commands and **C2 communication**.  

---

**View this and other reports on my GitHub:**  
[My Cybersecurity Portfolio](https://github.com/sapan322/Raman-Cybersecurity-Portfolio/tree/main)
