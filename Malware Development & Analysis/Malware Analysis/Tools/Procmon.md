# Procmon 
**Procmon** (Process Monitor) is an advanced monitoring tool for Windows that shows real-time file system, Registry and process/thread activity.

[Official Microsoft Tool Page](https://learn.microsoft.com/en-us/sysinternals/downloads/procmon)

Key Features of Procmon:
- Advanced monitoring and logging utility that reveals the who, what, when, where, and how of system-level events on Windows
- Real-time capture of file system changes, registry modifications, process/thread activity, and some network operations
- Powerful and flexible filtering system – allows filtering by process name, PID, operation type, result, path, and many other conditions

## Using Procmon for Malware Analysis
Procmon is an **extremely powerful tool** for dynamic malware analysis. It captures all system-level changes made by the malware during execution, including registry changes, file creations, subprocess executions, and more. This helps analysts understand the behavior and impact of the malware on the host system.

---

### Example: Analyzing the behavior of Malware.Unknown.exe

![2025-03-16 21_09_56-Window](https://github.com/user-attachments/assets/bf59a3cb-7da4-4e21-845f-17f21a3fbabf)

**Step-by-step:**
1. Start Procmon and create a filter:
```
 Process Name is Malware.Unknown.exe
```
2. Execute Malware.Unknown.exe
3. Procmon will capture and display:
    - Process names and PIDs
    - Registry changes
    - File operations (created, deleted, modified files)
    - Command-line arguments and loaded DLLs
    - Other detailed activity giving valuable insight into the malware’s behavior

### Example findings from Procmon:

Malware actions:
![2025-03-16 21_15_42-Window](https://github.com/user-attachments/assets/92380601-94aa-4d16-b49a-17714654b14e)

Malware download a second-stage payload and save it as `CR433101.dat.exe`:
![2025-03-16 21_25_10-Window](https://github.com/user-attachments/assets/cb64c8ba-3d6f-46ab-aa86-5704f7c6fcb3)

